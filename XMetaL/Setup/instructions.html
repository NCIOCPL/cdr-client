<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CDR XMetaL Installation</title>
    <style>
     body { font-family: Verdana, Helvetica, Arial, sans-serif }
     main { width: 80%; margin: 0 auto; }
     code { font-size: 1.1em; color: maroon; }
     h1, footer { text-align: center; }
     h1, h2, h3, h4 { color: navy; }
     ul { margin-top: 1rem; margin-bottom: 1rem; }
     ul > li { list-style-type: disc; }
     img { margin: 1rem auto 2rem; max-width: 100%}
     .note { color: green; font-size: .9em; font-style: italic; }
     .important {
         color: #b11;
         border: 1px solid #b11;
         padding: 1rem;
         font-size: .95em;
         font-style: italic;
     }
     .important code {
         display: block;
         margin: .5rem 2rem;
         font-style: normal;
     }
     .important code.mobile { display: none; }
     @media only screen and (max-width: 600px) {
         .important code { display: none; }
         .important code.mobile { display: block; margin-left: 1rem; }
         main { width: 100%; margin: 0; }
         ul { padding-left: 1rem; }
         ol { padding-left: 1.5rem; }
     }
    </style>
  </head>
  <body>
    <header>
      <h1>CDR XMetaL Installation</h1>
    </header>
    <main>
      <h2>Instructions for installing XMetaL 17 customized for the CDR</h2>
      <p>
        The standard approach for running these steps is to copy the folder
        in which this file resides (<code>CdrSetup17</code>) to the user's
        desktop. It is recommended that this folder be retained on the
        desktop after setup, in case the <code>repair-xmetal.cmd</code>
        script is needed at some time in the future, and to preserve the
        location of the XMetaL 17 license file. If at some point in the
        future you are instructed to refresh the contents of the folder in
        order to be able to take advantage of new enhancements or bug fixes,
        drag the folder to the desktop again, and when asked whether to
        replace or skip files, choose <em>Replace the files in the
        destination</em>.
      </p>
      <p>
        A normal installation for a new machine should take under ten minutes
        providing no unexpected problems arise.
      </p>
      <p>
        These steps require permission to install software on the machine.
        All of the current CDR XMetaL users are in the NCI CIPS CDR USERS
        security group and should have that permission but users need to
        refresh the security policies to ensure that they have the current
        version of those policies applied. You will need to file a
        ticket to have CBIIT grant that permission if it is missing.
        To run a command double-click on the command file in Windows Explorer.
        You will be presented with the <em>BeyondTrust Privilege Manager</em>
        window. Select <em>One-Off Task: I need to install an application</em>
        and click </strong>OK</strong> to proceed with the installation.
      </p>
      <p>
        Note that for the names of the commands invoked, the <code>.cmd</code>
        suffix may not be displayed if your computer is configured to suppress
        display of file-type suffixes.
      </p>
      <h3>Refresh Security Policies</h3>
      <p>
        Perform these steps to refresh security policies on your laptop before
        starting the installation processes. You do not need to be connected
        to the NIH VPN to perform the following steps. If you receive a failure
        message, ensure that you’re not connected to the NIH VPN then try
        again.
      </p>
      <ol>
        <li>
          Click on the Hidden Icons up arrow sign at the lower right corner of
          your laptop.
          <br>
          <img src="media\UpArrow.png" alt="Up Arrow Icon">
        </li>
        <li>
          Locate the <em>BeyondTrust Privilege Management</em> icon
          in the list of applications displayed.
          <br>
          <img src="media\BeyondTrust.png" alt="BeyondTrust Icon">
        </li>
        <li>
          Right-click on that icon and select <em>Refresh all policies</em>
          from the context menu which appears.
          <br>
          <img src="media\BeyondTrustRightClick.png"
               alt="BeyondTrust Right Click">
        </li>
        <ul>
          <li>
            You should get a notification about the status of the refresh.
            Ensure that the message is not a failure message. It is OK if
            you get the message <em>No Policy updates were found at this
            time. You have the latest version available</em>.
            <br>
            <img src="media\BeyondTrustNotification.png"
                 alt="BeyondTrust Notification">
          </li>
          <li>
            The message could also be hidden in the Notifications section of
            your laptop. Click on the Notifications icon to reveal the
            messages.
            <br>
            <img src="media\BeyondTrustNotificationHidden.png"
                 alt="BeyondTrust Notification Hidden">
            <br>
            <img src="media\BeyondTrustNotificationHiddenRevealed.png"
                 alt="BeyondTrust Notification Hidden Revealed">
          </li>
          <li>
            If you see a failure message like the one below, disconnect
            from the VPN (if you’re connected) and try to Refresh the
            policies again.
            If you’re not connected to the VPN and you continue to get
            a failure message, report this problem before proceeding with
            the installation.
            <br>
            <img src="media\BeyondTrustFailure.png"
                 alt="BeyondTrust Notification Hidden Revealed">
          </li>
          <li>
            It is OK if you receive a <em>Refresh Complete</em> message
            like the one below:
            <br>
            <img src="media\BeyondTrustComplete.png"
                 alt="BeyondTrust Notification Hidden Revealed">
          </li>
          <li>
            Once you have confirmed that the policy update has been
            successful, you may continue with the next steps of the
            installation.
          </li>
        </ul>
        <li>
          <strong>Please take note of the following when you begin the
          installation process</strong>: When you attempt to install
          software by double-clicking on a file, you will be presented
          with a window to choose a justification for the installation.
          Select <em>One-Off Task: I need to install an application</em>
          and click OK to proceed with the installation.
          <br>
          <img src="media\BeyondTrustJustification.png"
               alt="BeyondTrust Notification Hidden Revealed">
        </li>
      </ol>
      <h3>Basic Installation Steps</h3>
      <ol>
        <li>
          <h4>Install XMetaL</h4>
          <p>
            Run the <code>install-xmetal.cmd</code> script as described above.
            Expected time for the script is under a minute.
          </p>
        </li>
        <li>
          <h4>Install Python</h4>
          <p>
            Run the <code>install-python.cmd</code> script as described above.
            If a failure is reported which is not easily corrected, contact
            the CDR developers, providing any error output and logs from the
            PythonFiles subdirectory. Expected time for this script is under
            two minutes.
          </p>
        </li>
        <li>
          <h4>Install the CDR client files</h4>
          <p>
            Run the <code>run-setup.cmd</code> script as described above.
            The script will say where it found the XMetaL program and will
            describe what it is about to do, identifying the source and
            destination directories. You can abort at this point if something
            doesn't look right, but that's pretty unlikely, and in most
            cases you should just press the <strong>Enter</strong> key to
            proceed. The script generally takes less than a second to complete
            once you have confirmed that it can run.
          </p>
          <p>
            If the CDR icon on the desktop is a generic rectangle instead
            of a green circle, refer to the
            <a href="#repairing-xmetal"><em>Repairing XMetaL</em></a>
            section at the bottom of these instructions.
          </p>
        </li>
      </ol>
      <h3>Test the Installation</h3>
      <p>
        At this point you should be able to log into CDR XMetaL
        by double-clicking the CDR shortcut on the desktop, selecting
        a tier, and entering your NIH domain credentials.
      </p>
      <h2>Optional Post-Installation Procedures</h2>
      <p>
        A new machine may need to have two additional sets of files installed.
        These optional steps generally take about five minutes each, and are
        usually performed by the users themselves. In the case of a user who
        has not been granted sufficient permissions to copy the files to the
        machine's disk in the appropriate location(s), it may be necessary for
        CBIIT to assist in the process (though the ideal solution would be to
        grant the user the required permissions).
      </p>
      <ol>
        <li>
          <h4>For Board Managers</h4>
          <p>
            Install the CDR Word Macros and adjust MS Word settings by
            following the instructions in <em>Teams</em> (search for the
            <em>NCI OCPL Platform Support</em> channel and select the
            <em>Files</em> tab and navigate to
            <code>General &gt; Systems &gt; CDR</code>
            where you will find the document
            <em>Adding Word Macros to New Computer</em>).
          </p>
        </li>
        <li>
          <h4>
            For users with the need (and the license) for a medical dictionary
          </h4>
          <p>
            Install the dictionary file from the
            <em>Stedman's Medical Dictionary</em> following
            these instructions:
          </p>
          <ul>
            <li>
              start XMetaL (double-click on the green "CDR" icon on the
              desktop)
            </li>
            <li>load a document</li>
            <li>
              start the spellchecker
              (<code>Tools &gt; Spell Checker...</code> or press
              <code>F7</code>)
            </li>
            <li>
              on the <b>Writing Tools</b> pop-up window select the
              <em>Spell Checker</em> tab
            </li>
            <li>click <b>Options</b></li>
            <li>select <em>Main Word Lists...</em></li>
            <li>click <em>Add List...</em></li>
            <li>
              navigate to the directory on the L-drive
              <code>L:\OCPL\_Cross\CDR\STEDMANS</code>
              and select one of the <code>*.lex</code> files
              (TRADE, STEDMANS, or GENERIC)
              <span class="note">
                (<b>note:</b>
                it is recommended that the dictionaries be added in that order)
              </span>
            </li>
            <li>click <b>Open</b></li>
            <li>
              repeat the <em>Add List...</em> steps for the other
              two <code>*.lex</code> files
            </li>
            <li>close the pop-up windows</li>
          </ul>
          <p>
            You are now using the latest
            <em>Stedman's Medical Dictionary</em>.
          </p>
          <p>
            Users who already have a dictionary loaded that is located
            in a different directory may want to disable that
            dictionary or remove it from the list.
          </p>
        </li>
      </ol>

      <h2 id="repairing-xmetal">Repairing XMetaL</h2>
      <p>
        If the installation of XMetaL following the instructions above
        failed for any reason, it is generally preferable to attempt
        to repair the installation (rather than removing it and
        reinstalling), as follows.
      </p>
      <ul>
        <li>open a command console window as administrator.</li>
        <li>run appwiz.cpl</li>
        <li>select <em>XMetaL Author Essential (x64)</em></li>
        <li>
          click the <b>Change</b> button at the top of the list
          of installed programs
        </li>
        <li>
          select the <b>Repair</b> button on the
          <em>Program Maintenance</em> dialog box
        </li>
        <li>click the Next button</li>
        <li>follow the instructions to proceed with the repair</li>
        <li>run <code>run-setup.cmd</code> again</li>
        <li>
          if the CDR desktop icon is not a green circle, report the
          problem to the CDR developers and reschedule the CDR XMetaL setup
        </li>
      </ul>
      <p>
        On the other hand, the XMetaL application may at some point in the
        future occasionally fail to start properly, and ask for the location
        of the installation files. If this happens it is generally best to
        reinstall XMetaL. To do this, run the <code>repair-xmetal.cmd</code>
        script (which will actually remove and then reinstall XMetaL) in this
        directory as administrator. The script should complete in under a
        minute.
      </p>
    </main>
    <footer>
      <p class="note">Instructions last updated 2024-10-08</p>
    </footer>
  </body>
</html>
